<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />
  <title>Hello React!</title>
  <script src="https://unpkg.com/react@16/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@16/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.18.0/axios.min.js"></script>
</head>

<body>
  <div id="form">
  </div>
  <div>
    <h1>hi i am Ashu</h1>
  </div>
  <script type="text/babel">
  class Login extends React.Component {
    constructor(props)
    {
      super(props);
      this.state={
      tempCredential: {
        username:'',
        password:''
        }
      };
      this.handleChange = this.handleChange.bind(this);
      this.fetchFirst = this.fetchFirst.bind(this);
      this.fetchSecond = this.fetchSecond.bind(this);

    }
    handleChange(key) 
    {
      var that = this;
      return function(xyz) 
      {
        var temp = Object.assign({}, that.state.tempCredential);
        temp[key] = xyz.target.value;
        that.setState({ tempCredential:temp });
      };
    }
    fetchFirst() {
      var that=this;
		console.log(this.state.tempCredential)
      fetch("http://localhost:8080/login",{
        method: 'POST',
        body:that.state.tempCredential }).then(function (response) {
        return response.text();
      }).then(function (result) {
        //console.log(result.data.children);
        //that.setState({ posts: result.data.children, lastPostName: result.data.children[result.data.children.length - 1].data.name });
        console.log("gone1");
        console.log(result);
        console.log("gone2");
      });
    }
    fetchSecond(){
      console.log("called");
    axios.put('http://localhost:8080/login', {params:this.state.tempCredential})
  .then(function (response) {
    console.log(response);
  })
  .catch(function (error) {
    console.log(error);
  });
    }
    render() {
      return (
        <div>
          <table>
            <tr>
              <td>User Name:</td>
              <td><input type="text" value={this.state.tempCredential.username} onChange={this.handleChange("username")} required/></td>
            </tr>
            <tr>
              <td>Password:</td>
              <td><input type="password" value={this.state.tempCredential.password} onChange={this.handleChange("password")} required/></td>
            </tr>
            <tr>
              <td><button  onClick={this.fetchSecond}>Login</button></td>
              <td><button type="reset">Reset</button></td>
            </tr>
          </table>
        </div>
        );
      }
    };
  ReactDOM.render(<Login />, document.getElementById("form"));
	</script>
</body>

</html>